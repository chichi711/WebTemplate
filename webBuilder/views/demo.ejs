<%- begin %>
<%- body[0].body %>
<%- end %>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
    window.onload = () => {
        // window.top.location.href='/user';
        html2canvas(document.body, {
            height: window.innerHeight
        }).then(
            function (canvas) {//得到了canvas物件

                var imgObj = document.createElement('img');
                imgObj.src = canvas.toDataURL("image/jpg");//這裡通過canvas的toDataURL方法把它轉換成base64編碼。
                var mCanvas = document.createElement('canvas');
                mCanvas.width = 300;
                mCanvas.height = 300;
                var ctx = mCanvas.getContext('2d');
                ctx.drawImage(canvas, 0, 0, 300, 300);
                let imgUrl = mCanvas.toDataURL("image/jpg");
                let pic = { img: imgUrl };
                // document.body.innerHTML = `<img src=${imgUrl} />`;
                $.ajax({
                    type: "post",
                    url: "/edit/pic",
                    data: JSON.stringify(pic),
                    contentType: "application/json; charset=utf-8"
                });
            });
    }
</script>